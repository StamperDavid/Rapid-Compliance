{"numFailedTestSuites":4,"numFailedTests":6,"numPassedTestSuites":14,"numPassedTests":149,"numPendingTestSuites":0,"numPendingTests":4,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":18,"numTotalTests":159,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1766964088502,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["LeadService","createLead"],"duration":846,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService createLead should create a new lead with all required fields","invocations":1,"location":null,"numPassingAsserts":9,"retryReasons":[],"startAt":1766964089877,"status":"passed","title":"should create a new lead with all required fields"},{"ancestorTitles":["LeadService","createLead"],"duration":447,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService createLead should create lead with custom score","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964090724,"status":"passed","title":"should create lead with custom score"},{"ancestorTitles":["LeadService","getLead"],"duration":606,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService getLead should retrieve an existing lead","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964091171,"status":"passed","title":"should retrieve an existing lead"},{"ancestorTitles":["LeadService","getLead"],"duration":726,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService getLead should return null for non-existent lead","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964091777,"status":"passed","title":"should return null for non-existent lead"},{"ancestorTitles":["LeadService","updateLead"],"duration":955,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService updateLead should update lead fields","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1766964092503,"status":"passed","title":"should update lead fields"},{"ancestorTitles":["LeadService","getLeads with pagination"],"duration":3891,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService getLeads with pagination should retrieve leads with pagination","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1766964093458,"status":"passed","title":"should retrieve leads with pagination"},{"ancestorTitles":["LeadService","getLeads with pagination"],"duration":718,"failing":false,"failureDetails":[{}],"failureMessages":["Error: Failed to retrieve leads: 9 FAILED_PRECONDITION: The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/ai-sales-platform-dev/firestore/indexes?create_composite=ClVwcm9qZWN0cy9haS1zYWxlcy1wbGF0Zm9ybS1kZXYvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL3JlY29yZHMvaW5kZXhlcy9fEAEaCgoGc3RhdHVzEAEaDQoJY3JlYXRlZEF0EAIaDAoIX19uYW1lX18QAg\n    at getLeads (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\crm\\lead-service.ts:100:11)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\lead-service.test.ts:188:22)"],"fullName":"LeadService getLeads with pagination should filter leads by status","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964097349,"status":"failed","title":"should filter leads by status"},{"ancestorTitles":["LeadService","searchLeads"],"duration":616,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService searchLeads should search leads by name","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964098068,"status":"passed","title":"should search leads by name"},{"ancestorTitles":["LeadService","searchLeads"],"duration":615,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService searchLeads should search leads by email","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964098684,"status":"passed","title":"should search leads by email"},{"ancestorTitles":["LeadService","bulkUpdateLeads"],"duration":2822,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService bulkUpdateLeads should update multiple leads at once","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964099299,"status":"passed","title":"should update multiple leads at once"},{"ancestorTitles":["LeadService","deleteLead"],"duration":805,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"LeadService deleteLead should delete a lead","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964102121,"status":"passed","title":"should delete a lead"}],"endTime":1766964102937,"message":"  ● LeadService › getLeads with pagination › should filter leads by status\n\n    Failed to retrieve leads: 9 FAILED_PRECONDITION: The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/ai-sales-platform-dev/firestore/indexes?create_composite=ClVwcm9qZWN0cy9haS1zYWxlcy1wbGF0Zm9ybS1kZXYvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL3JlY29yZHMvaW5kZXhlcy9fEAEaCgoGc3RhdHVzEAEaDQoJY3JlYXRlZEF0EAIaDAoIX19uYW1lX18QAg\n\n       98 |   } catch (error: any) {\n       99 |     logger.error('Failed to get leads', error, { organizationId, workspaceId, filters });\n    > 100 |     throw new Error(`Failed to retrieve leads: ${error.message}`);\n          |           ^\n      101 |   }\n      102 | }\n      103 |\n\n      at getLeads (src/lib/crm/lead-service.ts:100:11)\n      at Object.<anonymous> (tests/services/lead-service.test.ts:188:22)\n","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\lead-service.test.ts","startTime":1766964088551,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["DealService","createDeal"],"duration":622,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"DealService createDeal should create a new deal","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"startAt":1766964103410,"status":"passed","title":"should create a new deal"},{"ancestorTitles":["DealService","moveDealToStage"],"duration":922,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"DealService moveDealToStage should move deal to new stage","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964104032,"status":"passed","title":"should move deal to new stage"},{"ancestorTitles":["DealService","moveDealToStage"],"duration":1003,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"DealService moveDealToStage should set close date when deal is won","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964104954,"status":"passed","title":"should set close date when deal is won"},{"ancestorTitles":["DealService","moveDealToStage"],"duration":908,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"DealService moveDealToStage should set probability to 0 when deal is lost","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964105957,"status":"passed","title":"should set probability to 0 when deal is lost"},{"ancestorTitles":["DealService","getDeals with pagination"],"duration":3522,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"DealService getDeals with pagination should paginate deals","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964106865,"status":"passed","title":"should paginate deals"},{"ancestorTitles":["DealService","getDeals with pagination"],"duration":791,"failing":false,"failureDetails":[{}],"failureMessages":["Error: Failed to retrieve deals: 9 FAILED_PRECONDITION: The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/ai-sales-platform-dev/firestore/indexes?create_composite=ClVwcm9qZWN0cy9haS1zYWxlcy1wbGF0Zm9ybS1kZXYvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL3JlY29yZHMvaW5kZXhlcy9fEAEaCQoFc3RhZ2UQARoNCgljcmVhdGVkQXQQAhoMCghfX25hbWVfXxAC\n    at getDeals (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\crm\\deal-service.ts:93:11)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\deal-service.test.ts:150:22)"],"fullName":"DealService getDeals with pagination should filter deals by stage","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964110388,"status":"failed","title":"should filter deals by stage"},{"ancestorTitles":["DealService","getPipelineSummary"],"duration":1344,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"DealService getPipelineSummary should calculate pipeline summary by stage","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964111179,"status":"passed","title":"should calculate pipeline summary by stage"}],"endTime":1766964112531,"message":"  ● DealService › getDeals with pagination › should filter deals by stage\n\n    Failed to retrieve deals: 9 FAILED_PRECONDITION: The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/ai-sales-platform-dev/firestore/indexes?create_composite=ClVwcm9qZWN0cy9haS1zYWxlcy1wbGF0Zm9ybS1kZXYvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL3JlY29yZHMvaW5kZXhlcy9fEAEaCQoFc3RhZ2UQARoNCgljcmVhdGVkQXQQAhoMCghfX25hbWVfXxAC\n\n      91 |   } catch (error: any) {\n      92 |     logger.error('Failed to get deals', error, { organizationId, filters });\n    > 93 |     throw new Error(`Failed to retrieve deals: ${error.message}`);\n         |           ^\n      94 |   }\n      95 | }\n      96 |\n\n      at getDeals (src/lib/crm/deal-service.ts:93:11)\n      at Object.<anonymous> (tests/services/deal-service.test.ts:150:22)\n","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\deal-service.test.ts","startTime":1766964102949,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["E-Commerce UI Integration"],"duration":349,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"E-Commerce UI Integration should create cart (products page → cart service)","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964113585,"status":"passed","title":"should create cart (products page → cart service)"},{"ancestorTitles":["E-Commerce UI Integration"],"duration":348,"failing":false,"failureDetails":[{}],"failureMessages":["Error: Value for argument \"data\" is not a valid Firestore document. Cannot use \"undefined\" as a Firestore value (found in field \"items.`0`.variantId\"). If you want to ignore undefined values, enable `ignoreUndefinedProperties`.\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:383:19)\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:375:13)\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:369:13)\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:375:13)\n    at validateDocumentData (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\write-batch.js:609:40)\n    at WriteBatch.set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\write-batch.js:263:9)\n    at C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\reference\\document-reference.js:348:41\n    at C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\telemetry\\enabled-trace-util.js:110:30\n    at NoopContextManager.with (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\context\\NoopContextManager.ts:31:15)\n    at ContextAPI.with (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\api\\context.ts:77:42)\n    at NoopTracer.startActiveSpan (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\trace\\NoopTracer.ts:98:27)\n    at ProxyTracer.startActiveSpan (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\trace\\ProxyTracer.ts:51:20)\n    at EnabledTraceUtil.startActiveSpan (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\telemetry\\enabled-trace-util.js:102:28)\n    at DocumentReference.set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\reference\\document-reference.js:342:43)\n    at AdminFirestoreService.set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\db\\admin-firestore-service.ts:210:22)\n    at set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\ecommerce\\cart-service.ts:297:26)\n    at saveCart (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\ecommerce\\cart-service.ts:141:9)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\ui-pages.test.ts:68:18)"],"fullName":"E-Commerce UI Integration should add product to cart (product detail → cart service)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964113934,"status":"failed","title":"should add product to cart (product detail → cart service)"},{"ancestorTitles":["E-Commerce UI Integration"],"duration":432,"failing":false,"failureDetails":[{}],"failureMessages":["Error: Value for argument \"data\" is not a valid Firestore document. Cannot use \"undefined\" as a Firestore value (found in field \"items.`0`.variantId\"). If you want to ignore undefined values, enable `ignoreUndefinedProperties`.\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:383:19)\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:375:13)\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:369:13)\n    at validateUserInput (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\serializer.js:375:13)\n    at validateDocumentData (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\write-batch.js:609:40)\n    at WriteBatch.set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\write-batch.js:263:9)\n    at C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\reference\\document-reference.js:348:41\n    at C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\telemetry\\enabled-trace-util.js:110:30\n    at NoopContextManager.with (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\context\\NoopContextManager.ts:31:15)\n    at ContextAPI.with (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\api\\context.ts:77:42)\n    at NoopTracer.startActiveSpan (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\trace\\NoopTracer.ts:98:27)\n    at ProxyTracer.startActiveSpan (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@opentelemetry\\api\\src\\trace\\ProxyTracer.ts:51:20)\n    at EnabledTraceUtil.startActiveSpan (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\telemetry\\enabled-trace-util.js:102:28)\n    at DocumentReference.set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\node_modules\\@google-cloud\\firestore\\build\\src\\reference\\document-reference.js:342:43)\n    at AdminFirestoreService.set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\db\\admin-firestore-service.ts:210:22)\n    at set (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\ecommerce\\cart-service.ts:297:26)\n    at saveCart (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\ecommerce\\cart-service.ts:141:9)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\ui-pages.test.ts:76:5)"],"fullName":"E-Commerce UI Integration should process checkout (checkout page → checkout service)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964114283,"status":"failed","title":"should process checkout (checkout page → checkout service)"},{"ancestorTitles":["Workflow UI Integration"],"duration":120,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Workflow UI Integration should list workflows (workflows page → firestore)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964114716,"status":"passed","title":"should list workflows (workflows page → firestore)"},{"ancestorTitles":["Workflow UI Integration"],"duration":424,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Workflow UI Integration should create workflow (workflow builder → firestore)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964114836,"status":"passed","title":"should create workflow (workflow builder → firestore)"},{"ancestorTitles":["Workflow UI Integration"],"duration":1194,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Workflow UI Integration should execute workflow (workflow page → workflow engine)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964115260,"status":"passed","title":"should execute workflow (workflow page → workflow engine)"},{"ancestorTitles":["Email Campaign UI Integration"],"duration":631,"failing":false,"failureDetails":[{"code":"permission-denied","name":"FirebaseError"}],"failureMessages":["FirebaseError: 7 PERMISSION_DENIED: Missing or insufficient permissions."],"fullName":"Email Campaign UI Integration should create campaign (campaign builder → campaign service)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964116454,"status":"failed","title":"should create campaign (campaign builder → campaign service)"},{"ancestorTitles":["Email Campaign UI Integration"],"duration":157,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Campaign UI Integration should list campaigns (campaigns page → campaign service)","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964117085,"status":"passed","title":"should list campaigns (campaigns page → campaign service)"},{"ancestorTitles":["CRM UI Integration"],"duration":111,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CRM UI Integration should list leads (leads page → firestore)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964117242,"status":"passed","title":"should list leads (leads page → firestore)"},{"ancestorTitles":["CRM UI Integration"],"duration":230,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CRM UI Integration should list deals (deals page → firestore)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964117354,"status":"passed","title":"should list deals (deals page → firestore)"},{"ancestorTitles":["CRM UI Integration"],"duration":106,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CRM UI Integration should list contacts (contacts page → firestore)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964117584,"status":"passed","title":"should list contacts (contacts page → firestore)"},{"ancestorTitles":["CRM UI Integration"],"duration":338,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CRM UI Integration should create lead (leads page → firestore)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964117690,"status":"passed","title":"should create lead (leads page → firestore)"},{"ancestorTitles":["Product Management UI Integration"],"duration":342,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Product Management UI Integration should create product (product form → firestore)","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964118028,"status":"passed","title":"should create product (product form → firestore)"},{"ancestorTitles":["Product Management UI Integration"],"duration":234,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Product Management UI Integration should list products for admin (products page → firestore)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964118370,"status":"passed","title":"should list products for admin (products page → firestore)"},{"ancestorTitles":["Product Management UI Integration"],"duration":98,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Product Management UI Integration should list products for customers (store page → firestore)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964118604,"status":"passed","title":"should list products for customers (store page → firestore)"}],"endTime":1766964118713,"message":"  ● E-Commerce UI Integration › should add product to cart (product detail → cart service)\n\n    Value for argument \"data\" is not a valid Firestore document. Cannot use \"undefined\" as a Firestore value (found in field \"items.`0`.variantId\"). If you want to ignore undefined values, enable `ignoreUndefinedProperties`.\n\n      208 |         await docRef.set(data, { merge: true });\n      209 |       } else {\n    > 210 |         await docRef.set(data);\n          |                      ^\n      211 |       }\n      212 |     } catch (error) {\n      213 |       logger.error('[Admin Firestore] Error setting document ${collectionPath}/${docId}:', error, { file: 'admin-firestore-service.ts' });\n\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:383:19)\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:375:13)\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:369:13)\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:375:13)\n      at validateDocumentData (node_modules/@google-cloud/firestore/build/src/write-batch.js:609:40)\n      at WriteBatch.set (node_modules/@google-cloud/firestore/build/src/write-batch.js:263:9)\n      at node_modules/@google-cloud/firestore/build/src/reference/document-reference.js:348:41\n      at node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30\n      at NoopContextManager.with (node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)\n      at ContextAPI.with (node_modules/@opentelemetry/api/src/api/context.ts:77:42)\n      at NoopTracer.startActiveSpan (node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)\n      at ProxyTracer.startActiveSpan (node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)\n      at EnabledTraceUtil.startActiveSpan (node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)\n      at DocumentReference.set (node_modules/@google-cloud/firestore/build/src/reference/document-reference.js:342:43)\n      at AdminFirestoreService.set (src/lib/db/admin-firestore-service.ts:210:22)\n      at set (src/lib/ecommerce/cart-service.ts:297:26)\n      at saveCart (src/lib/ecommerce/cart-service.ts:141:9)\n      at Object.<anonymous> (tests/integration/ui-pages.test.ts:68:18)\n\n  ● E-Commerce UI Integration › should process checkout (checkout page → checkout service)\n\n    Value for argument \"data\" is not a valid Firestore document. Cannot use \"undefined\" as a Firestore value (found in field \"items.`0`.variantId\"). If you want to ignore undefined values, enable `ignoreUndefinedProperties`.\n\n      208 |         await docRef.set(data, { merge: true });\n      209 |       } else {\n    > 210 |         await docRef.set(data);\n          |                      ^\n      211 |       }\n      212 |     } catch (error) {\n      213 |       logger.error('[Admin Firestore] Error setting document ${collectionPath}/${docId}:', error, { file: 'admin-firestore-service.ts' });\n\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:383:19)\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:375:13)\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:369:13)\n      at validateUserInput (node_modules/@google-cloud/firestore/build/src/serializer.js:375:13)\n      at validateDocumentData (node_modules/@google-cloud/firestore/build/src/write-batch.js:609:40)\n      at WriteBatch.set (node_modules/@google-cloud/firestore/build/src/write-batch.js:263:9)\n      at node_modules/@google-cloud/firestore/build/src/reference/document-reference.js:348:41\n      at node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30\n      at NoopContextManager.with (node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)\n      at ContextAPI.with (node_modules/@opentelemetry/api/src/api/context.ts:77:42)\n      at NoopTracer.startActiveSpan (node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)\n      at ProxyTracer.startActiveSpan (node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)\n      at EnabledTraceUtil.startActiveSpan (node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)\n      at DocumentReference.set (node_modules/@google-cloud/firestore/build/src/reference/document-reference.js:342:43)\n      at AdminFirestoreService.set (src/lib/db/admin-firestore-service.ts:210:22)\n      at set (src/lib/ecommerce/cart-service.ts:297:26)\n      at saveCart (src/lib/ecommerce/cart-service.ts:141:9)\n      at Object.<anonymous> (tests/integration/ui-pages.test.ts:76:5)\n\n  ● Email Campaign UI Integration › should create campaign (campaign builder → campaign service)\n\n    FirebaseError: 7 PERMISSION_DENIED: Missing or insufficient permissions.\n\n","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\ui-pages.test.ts","startTime":1766964112538,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["WorkflowService","createWorkflow"],"duration":744,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WorkflowService createWorkflow should create a new workflow","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1766964119157,"status":"passed","title":"should create a new workflow"},{"ancestorTitles":["WorkflowService","setWorkflowStatus"],"duration":690,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WorkflowService setWorkflowStatus should activate workflow","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964119901,"status":"passed","title":"should activate workflow"},{"ancestorTitles":["WorkflowService","setWorkflowStatus"],"duration":836,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WorkflowService setWorkflowStatus should pause workflow","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964120591,"status":"passed","title":"should pause workflow"},{"ancestorTitles":["WorkflowService","getWorkflows with filters"],"duration":705,"failing":false,"failureDetails":[{}],"failureMessages":["Error: Failed to retrieve workflows: 9 FAILED_PRECONDITION: The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/ai-sales-platform-dev/firestore/indexes?create_composite=Cldwcm9qZWN0cy9haS1zYWxlcy1wbGF0Zm9ybS1kZXYvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL3dvcmtmbG93cy9pbmRleGVzL18QARoKCgZzdGF0dXMQARoNCgljcmVhdGVkQXQQAhoMCghfX25hbWVfXxAC\n    at getWorkflows (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\src\\lib\\workflows\\workflow-service.ts:67:11)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\workflow-service.test.ts:167:22)"],"fullName":"WorkflowService getWorkflows with filters should filter workflows by status","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964121427,"status":"failed","title":"should filter workflows by status"}],"endTime":1766964122134,"message":"  ● WorkflowService › getWorkflows with filters › should filter workflows by status\n\n    Failed to retrieve workflows: 9 FAILED_PRECONDITION: The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/ai-sales-platform-dev/firestore/indexes?create_composite=Cldwcm9qZWN0cy9haS1zYWxlcy1wbGF0Zm9ybS1kZXYvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL3dvcmtmbG93cy9pbmRleGVzL18QARoKCgZzdGF0dXMQARoNCgljcmVhdGVkQXQQAhoMCghfX25hbWVfXxAC\n\n      65 |   } catch (error: any) {\n      66 |     logger.error('Failed to get workflows', error, { organizationId, filters });\n    > 67 |     throw new Error(`Failed to retrieve workflows: ${error.message}`);\n         |           ^\n      68 |   }\n      69 | }\n      70 |\n\n      at getWorkflows (src/lib/workflows/workflow-service.ts:67:11)\n      at Object.<anonymous> (tests/services/workflow-service.test.ts:167:22)\n","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\workflow-service.test.ts","startTime":1766964118721,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Pagination Stress Testing"],"duration":313,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Pagination Stress Testing should paginate leads without crashing (200 records)","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1766964155016,"status":"passed","title":"should paginate leads without crashing (200 records)"},{"ancestorTitles":["Pagination Stress Testing"],"duration":126,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Pagination Stress Testing should paginate deals without timeout (100 records)","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964155329,"status":"passed","title":"should paginate deals without timeout (100 records)"},{"ancestorTitles":["Pagination Stress Testing"],"duration":112,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Pagination Stress Testing should handle empty collections gracefully","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964155455,"status":"passed","title":"should handle empty collections gracefully"},{"ancestorTitles":["Pagination Stress Testing"],"duration":574,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Pagination Stress Testing should iterate through all pages correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964155567,"status":"passed","title":"should iterate through all pages correctly"}],"endTime":1766964156142,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\pagination-validation.test.ts","startTime":1766964122138,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["ProductService","createProduct"],"duration":632,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService createProduct should create a new product","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1766964156598,"status":"passed","title":"should create a new product"},{"ancestorTitles":["ProductService","createProduct"],"duration":527,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService createProduct should create digital product","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964157230,"status":"passed","title":"should create digital product"},{"ancestorTitles":["ProductService","updateInventory"],"duration":834,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService updateInventory should decrease inventory when product is purchased","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964157757,"status":"passed","title":"should decrease inventory when product is purchased"},{"ancestorTitles":["ProductService","updateInventory"],"duration":862,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService updateInventory should mark product out of stock when inventory reaches 0","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964158592,"status":"passed","title":"should mark product out of stock when inventory reaches 0"},{"ancestorTitles":["ProductService","updateInventory"],"duration":661,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService updateInventory should not update inventory for non-tracked products","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964159454,"status":"passed","title":"should not update inventory for non-tracked products"},{"ancestorTitles":["ProductService","searchProducts"],"duration":671,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService searchProducts should search products by name","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964160115,"status":"passed","title":"should search products by name"},{"ancestorTitles":["ProductService","getProducts with filters"],"duration":974,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ProductService getProducts with filters should filter products by price range","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964160786,"status":"passed","title":"should filter products by price range"}],"endTime":1766964161760,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\services\\product-service.test.ts","startTime":1766964156150,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Payment Integration Tests","Fee Calculations (Always Works)"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Integration Tests Fee Calculations (Always Works) should calculate Stripe fees correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964162606,"status":"passed","title":"should calculate Stripe fees correctly"},{"ancestorTitles":["Payment Integration Tests","Fee Calculations (Always Works)"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Integration Tests Fee Calculations (Always Works) should calculate PayPal fees correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964162607,"status":"passed","title":"should calculate PayPal fees correctly"},{"ancestorTitles":["Payment Integration Tests","Payment Processing (Requires Stripe Test Key)"],"duration":112,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Integration Tests Payment Processing (Requires Stripe Test Key) should process Stripe payment in test mode","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964162607,"status":"passed","title":"should process Stripe payment in test mode"},{"ancestorTitles":["Payment Integration Tests","Payment Processing (Requires Stripe Test Key)"],"duration":186,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Integration Tests Payment Processing (Requires Stripe Test Key) should handle payment failure gracefully","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964162719,"status":"passed","title":"should handle payment failure gracefully"},{"ancestorTitles":["Payment Integration Tests","Payment Provider Routing"],"duration":224,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Integration Tests Payment Provider Routing should return error if no provider configured","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964162905,"status":"passed","title":"should return error if no provider configured"},{"ancestorTitles":["Payment Integration Tests","Payment Security"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Integration Tests Payment Security should not expose sensitive data in logs","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163129,"status":"passed","title":"should not expose sensitive data in logs"}],"endTime":1766964163130,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\payment-integration.test.ts","startTime":1766964161767,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["OAuth Service","Authorization URL Generation"],"duration":320,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"OAuth Service Authorization URL Generation should generate valid OAuth URL with state token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163227,"status":"passed","title":"should generate valid OAuth URL with state token"},{"ancestorTitles":["OAuth Service","Supported Providers"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"OAuth Service Supported Providers should support Google OAuth","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163547,"status":"passed","title":"should support Google OAuth"},{"ancestorTitles":["OAuth Service","Supported Providers"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"OAuth Service Supported Providers should support Microsoft OAuth","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163547,"status":"passed","title":"should support Microsoft OAuth"},{"ancestorTitles":["OAuth Service","Supported Providers"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"OAuth Service Supported Providers should support QuickBooks OAuth","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163548,"status":"passed","title":"should support QuickBooks OAuth"},{"ancestorTitles":["OAuth Service","Supported Providers"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"OAuth Service Supported Providers should support Xero OAuth","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163548,"status":"passed","title":"should support Xero OAuth"},{"ancestorTitles":["QuickBooks Service","Customer Sync"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"QuickBooks Service Customer Sync should format customer data for QuickBooks API","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163548,"status":"passed","title":"should format customer data for QuickBooks API"},{"ancestorTitles":["QuickBooks Service","Invoice Creation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"QuickBooks Service Invoice Creation should format invoice data correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163556,"status":"passed","title":"should format invoice data correctly"},{"ancestorTitles":["QuickBooks Service","Payment Recording"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"QuickBooks Service Payment Recording should format payment data correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163556,"status":"passed","title":"should format payment data correctly"},{"ancestorTitles":["Xero Service","Contact Sync"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Xero Service Contact Sync should format contact data for Xero API","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163556,"status":"passed","title":"should format contact data for Xero API"},{"ancestorTitles":["Xero Service","Invoice Creation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Xero Service Invoice Creation should create invoices in Xero format","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163564,"status":"passed","title":"should create invoices in Xero format"},{"ancestorTitles":["Xero Service","Payment Recording"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Xero Service Payment Recording should record payments in Xero","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163564,"status":"passed","title":"should record payments in Xero"},{"ancestorTitles":["Xero Service","Tenant Management"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Xero Service Tenant Management should fetch available Xero tenants","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163564,"status":"passed","title":"should fetch available Xero tenants"}],"endTime":1766964163565,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\oauth-service.test.ts","startTime":1766964163136,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Schema Adaptability System","Schema Change Detection"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Schema Change Detection should detect field rename","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964163869,"status":"passed","title":"should detect field rename"},{"ancestorTitles":["Schema Adaptability System","Schema Change Detection"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Schema Change Detection should detect field deletion","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964163870,"status":"passed","title":"should detect field deletion"},{"ancestorTitles":["Schema Adaptability System","Schema Change Detection"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Schema Change Detection should detect schema rename","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964163871,"status":"passed","title":"should detect schema rename"},{"ancestorTitles":["Schema Adaptability System","Field Resolver"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Field Resolver should resolve exact key match","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964163871,"status":"passed","title":"should resolve exact key match"},{"ancestorTitles":["Schema Adaptability System","Field Resolver"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Field Resolver should resolve field by common alias","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964163872,"status":"passed","title":"should resolve field by common alias"},{"ancestorTitles":["Schema Adaptability System","Field Resolver"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Field Resolver should resolve field by partial label match","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964163872,"status":"passed","title":"should resolve field by partial label match"},{"ancestorTitles":["Schema Adaptability System","Field Resolver"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Field Resolver should get field value from record","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163873,"status":"passed","title":"should get field value from record"},{"ancestorTitles":["Schema Adaptability System","Field Resolver"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Field Resolver should handle nested field values","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163873,"status":"passed","title":"should handle nested field values"},{"ancestorTitles":["Schema Adaptability System","Field Resolver"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Field Resolver should validate field references","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163873,"status":"passed","title":"should validate field references"},{"ancestorTitles":["Schema Adaptability System","E-Commerce Mapping Adapter"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System E-Commerce Mapping Adapter should auto-configure product mappings","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163874,"status":"passed","title":"should auto-configure product mappings"},{"ancestorTitles":["Schema Adaptability System","Workflow Validation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Workflow Validation should validate workflow with valid field references","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163874,"status":"passed","title":"should validate workflow with valid field references"},{"ancestorTitles":["Schema Adaptability System","Workflow Validation"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Workflow Validation should detect invalid field references in workflows","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964163874,"status":"passed","title":"should detect invalid field references in workflows"},{"ancestorTitles":["Schema Adaptability System","Integration Scenarios"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Schema Adaptability System Integration Scenarios should handle field rename scenario end-to-end","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964163875,"status":"passed","title":"should handle field rename scenario end-to-end"}],"endTime":1766964163876,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\schema-adaptability.test.ts","startTime":1766964163570,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Payment Service","Fee Calculations"],"duration":129,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Fee Calculations should calculate Stripe fees correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964163971,"status":"passed","title":"should calculate Stripe fees correctly"},{"ancestorTitles":["Payment Service","Fee Calculations"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Fee Calculations should calculate Square fees correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164100,"status":"passed","title":"should calculate Square fees correctly"},{"ancestorTitles":["Payment Service","Fee Calculations"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Fee Calculations should calculate PayPal fees correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164100,"status":"passed","title":"should calculate PayPal fees correctly"},{"ancestorTitles":["Payment Service","Fee Calculations"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Fee Calculations should calculate Razorpay fees correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164101,"status":"passed","title":"should calculate Razorpay fees correctly"},{"ancestorTitles":["Payment Service","Provider Routing"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Provider Routing should route to correct payment provider","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164110,"status":"passed","title":"should route to correct payment provider"},{"ancestorTitles":["Payment Service","Payment Providers List"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Payment Providers List should have 8 payment providers configured","invocations":1,"location":null,"numPassingAsserts":9,"retryReasons":[],"startAt":1766964164110,"status":"passed","title":"should have 8 payment providers configured"},{"ancestorTitles":["Payment Service","Payment Providers List"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Payment Service Payment Providers List should have provider metadata","invocations":1,"location":null,"numPassingAsserts":40,"retryReasons":[],"startAt":1766964164111,"status":"passed","title":"should have provider metadata"}],"endTime":1766964164113,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\payment-service.test.ts","startTime":1766964163880,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Email Integration Tests","Email Sending (Requires SendGrid/Gmail Test Config)"],"duration":null,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Sending (Requires SendGrid/Gmail Test Config) should send email via SendGrid","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964164352,"status":"pending","title":"should send email via SendGrid"},{"ancestorTitles":["Email Integration Tests","Email Sending (Requires SendGrid/Gmail Test Config)"],"duration":null,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Sending (Requires SendGrid/Gmail Test Config) should send email via Gmail API","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964164352,"status":"pending","title":"should send email via Gmail API"},{"ancestorTitles":["Email Integration Tests","Email Template Rendering"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Template Rendering should replace variables in email templates","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164352,"status":"passed","title":"should replace variables in email templates"},{"ancestorTitles":["Email Integration Tests","Email Validation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Validation should validate email addresses","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"startAt":1766964164353,"status":"passed","title":"should validate email addresses"},{"ancestorTitles":["Email Integration Tests","Email Tracking"],"duration":9,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Tracking should generate tracking pixels","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964164353,"status":"passed","title":"should generate tracking pixels"},{"ancestorTitles":["Email Integration Tests","Email Tracking"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Tracking should wrap links with tracking","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964164362,"status":"passed","title":"should wrap links with tracking"},{"ancestorTitles":["Email Integration Tests","Email Bounce Handling"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Email Integration Tests Email Bounce Handling should classify bounce types","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"startAt":1766964164363,"status":"passed","title":"should classify bounce types"}],"endTime":1766964164364,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\email-integration.test.ts","startTime":1766964164124,"status":"focused","summary":""},{"assertionResults":[{"ancestorTitles":["SMS Integration Tests","SMS Sending (Requires Twilio Test Account)"],"duration":null,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SMS Integration Tests SMS Sending (Requires Twilio Test Account) should send SMS via Twilio test mode","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964164585,"status":"pending","title":"should send SMS via Twilio test mode"},{"ancestorTitles":["SMS Integration Tests","SMS Sending (Requires Twilio Test Account)"],"duration":null,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SMS Integration Tests SMS Sending (Requires Twilio Test Account) should handle invalid phone numbers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766964164585,"status":"pending","title":"should handle invalid phone numbers"},{"ancestorTitles":["SMS Integration Tests","SMS Provider Configuration"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SMS Integration Tests SMS Provider Configuration should have Twilio and Vonage providers configured","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964164585,"status":"passed","title":"should have Twilio and Vonage providers configured"},{"ancestorTitles":["SMS Integration Tests","Phone Number Validation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SMS Integration Tests Phone Number Validation should validate phone numbers","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1766964164587,"status":"passed","title":"should validate phone numbers"},{"ancestorTitles":["SMS Integration Tests","SMS Templates"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SMS Integration Tests SMS Templates should support variable replacement in templates","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164587,"status":"passed","title":"should support variable replacement in templates"}],"endTime":1766964164588,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\sms-integration.test.ts","startTime":1766964164368,"status":"focused","summary":""},{"assertionResults":[{"ancestorTitles":["Validation Schemas","emailSendSchema"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas emailSendSchema should validate correct email data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164701,"status":"passed","title":"should validate correct email data"},{"ancestorTitles":["Validation Schemas","emailSendSchema"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas emailSendSchema should reject invalid email","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164703,"status":"passed","title":"should reject invalid email"},{"ancestorTitles":["Validation Schemas","emailSendSchema"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas emailSendSchema should require organizationId","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164704,"status":"passed","title":"should require organizationId"},{"ancestorTitles":["Validation Schemas","emailSendSchema"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas emailSendSchema should require either html or text","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164704,"status":"passed","title":"should require either html or text"},{"ancestorTitles":["Validation Schemas","smsSendSchema"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas smsSendSchema should validate correct SMS data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164705,"status":"passed","title":"should validate correct SMS data"},{"ancestorTitles":["Validation Schemas","smsSendSchema"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas smsSendSchema should require organizationId","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164705,"status":"passed","title":"should require organizationId"},{"ancestorTitles":["Validation Schemas","createPaymentIntentSchema"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas createPaymentIntentSchema should validate correct payment intent data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164705,"status":"passed","title":"should validate correct payment intent data"},{"ancestorTitles":["Validation Schemas","createPaymentIntentSchema"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas createPaymentIntentSchema should reject negative amounts","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164706,"status":"passed","title":"should reject negative amounts"},{"ancestorTitles":["Validation Schemas","workflowExecuteSchema"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas workflowExecuteSchema should validate correct workflow execution data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164706,"status":"passed","title":"should validate correct workflow execution data"},{"ancestorTitles":["Validation Schemas","leadScoringSchema"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas leadScoringSchema should validate correct lead scoring data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164706,"status":"passed","title":"should validate correct lead scoring data"},{"ancestorTitles":["Validation Schemas","createCampaignSchema"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Validation Schemas createCampaignSchema should validate correct campaign data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164707,"status":"passed","title":"should validate correct campaign data"}],"endTime":1766964164708,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\validation.test.ts","startTime":1766964164592,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Data Isolation"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Data Isolation should prevent Org A from reading Org B pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164808,"status":"passed","title":"should prevent Org A from reading Org B pages"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Data Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Data Isolation should prevent Org A from updating Org B pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164809,"status":"passed","title":"should prevent Org A from updating Org B pages"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Data Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Data Isolation should prevent Org A from deleting Org B pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164809,"status":"passed","title":"should prevent Org A from deleting Org B pages"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Data Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Data Isolation should prevent changing organizationId on page update","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164810,"status":"passed","title":"should prevent changing organizationId on page update"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Subdomain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Subdomain Isolation should route orgA.platform.com to Org A only","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164810,"status":"passed","title":"should route orgA.platform.com to Org A only"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Subdomain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Subdomain Isolation should route orgB.platform.com to Org B only","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164810,"status":"passed","title":"should route orgB.platform.com to Org B only"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Subdomain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Subdomain Isolation should return 404 for non-existent subdomain","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164810,"status":"passed","title":"should return 404 for non-existent subdomain"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Subdomain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Subdomain Isolation should prevent subdomain conflicts","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164810,"status":"passed","title":"should prevent subdomain conflicts"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Custom Domain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Custom Domain Isolation should map custom domain to single org only","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164811,"status":"passed","title":"should map custom domain to single org only"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Custom Domain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Custom Domain Isolation should prevent domain hijacking","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164811,"status":"passed","title":"should prevent domain hijacking"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Custom Domain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Custom Domain Isolation should require DNS verification before activation","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164811,"status":"passed","title":"should require DNS verification before activation"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Custom Domain Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Custom Domain Isolation should prevent changing organizationId of claimed domain","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164811,"status":"passed","title":"should prevent changing organizationId of claimed domain"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Published vs Draft Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Published vs Draft Isolation should allow public access to published pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164811,"status":"passed","title":"should allow public access to published pages"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Published vs Draft Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Published vs Draft Isolation should require authentication for draft pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164812,"status":"passed","title":"should require authentication for draft pages"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Published vs Draft Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Published vs Draft Isolation should prevent cross-org access to drafts","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164812,"status":"passed","title":"should prevent cross-org access to drafts"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","API Security"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation API Security should require organizationId on all requests","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164812,"status":"passed","title":"should require organizationId on all requests"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","API Security"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation API Security should validate user belongs to requested org","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164812,"status":"passed","title":"should validate user belongs to requested org"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","API Security"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation API Security should double-check organizationId in responses","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164812,"status":"passed","title":"should double-check organizationId in responses"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","API Security"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation API Security should log security violations","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164812,"status":"passed","title":"should log security violations"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Cache Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Cache Isolation should not cache cross-org content","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164813,"status":"passed","title":"should not cache cross-org content"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Cache Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Cache Isolation should vary cache by hostname","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164813,"status":"passed","title":"should vary cache by hostname"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Media/Asset Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Media/Asset Isolation should store assets in org-scoped paths","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164813,"status":"passed","title":"should store assets in org-scoped paths"},{"ancestorTitles":["Website Builder - Multi-Tenant Isolation","Media/Asset Isolation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Website Builder - Multi-Tenant Isolation Media/Asset Isolation should prevent cross-org asset access","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164813,"status":"passed","title":"should prevent cross-org asset access"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should allow org members to read their own pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164813,"status":"passed","title":"should allow org members to read their own pages"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should deny cross-org page reads","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164814,"status":"passed","title":"should deny cross-org page reads"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should require manager+ role for page edits","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164814,"status":"passed","title":"should require manager+ role for page edits"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should validate organizationId on document create","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164814,"status":"passed","title":"should validate organizationId on document create"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should prevent organizationId modification","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164814,"status":"passed","title":"should prevent organizationId modification"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should allow public read for published pages","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164814,"status":"passed","title":"should allow public read for published pages"},{"ancestorTitles":["Firestore Security Rules - Website Builder"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Firestore Security Rules - Website Builder should prevent domain hijacking via rules","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164815,"status":"passed","title":"should prevent domain hijacking via rules"}],"endTime":1766964164815,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\website-multi-tenant.test.ts","startTime":1766964164717,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["API Routes","/api/agent/chat"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/agent/chat should handle chat requests","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164909,"status":"passed","title":"should handle chat requests"},{"ancestorTitles":["API Routes","/api/agent/chat"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/agent/chat should enforce rate limiting","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164910,"status":"passed","title":"should enforce rate limiting"},{"ancestorTitles":["API Routes","/api/agent/chat"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/agent/chat should require authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164910,"status":"passed","title":"should require authentication"},{"ancestorTitles":["API Routes","/api/agent/config"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/agent/config should save agent configuration","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164910,"status":"passed","title":"should save agent configuration"},{"ancestorTitles":["API Routes","/api/agent/config"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/agent/config should load agent configuration","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164911,"status":"passed","title":"should load agent configuration"},{"ancestorTitles":["API Routes","/api/ecommerce/checkout"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/ecommerce/checkout should process checkout","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164911,"status":"passed","title":"should process checkout"},{"ancestorTitles":["API Routes","/api/ecommerce/checkout"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Routes /api/ecommerce/checkout should validate cart before checkout","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964164911,"status":"passed","title":"should validate cart before checkout"}],"endTime":1766964164912,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\integration\\api-routes.test.ts","startTime":1766964164820,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Rate Limiting"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Rate Limiting should allow requests within limit","invocations":1,"location":null,"numPassingAsserts":10,"retryReasons":[],"startAt":1766964165003,"status":"passed","title":"should allow requests within limit"},{"ancestorTitles":["Rate Limiting"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Rate Limiting should block requests exceeding limit","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165004,"status":"passed","title":"should block requests exceeding limit"},{"ancestorTitles":["Rate Limiting"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Rate Limiting should reset after time window","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964165004,"status":"passed","title":"should reset after time window"},{"ancestorTitles":["Rate Limiting"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Rate Limiting should track different users separately","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766964165005,"status":"passed","title":"should track different users separately"}],"endTime":1766964165005,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\rate-limiting.test.ts","startTime":1766964164915,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Authentication Middleware"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Middleware should reject requests without authorization header","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165098,"status":"passed","title":"should reject requests without authorization header"},{"ancestorTitles":["Authentication Middleware"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Middleware should reject requests with invalid token format","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165099,"status":"passed","title":"should reject requests with invalid token format"},{"ancestorTitles":["Authentication Middleware"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Middleware should reject requests with invalid token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165100,"status":"passed","title":"should reject requests with invalid token"},{"ancestorTitles":["Authentication Middleware"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Middleware should accept requests with valid token","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1766964165100,"status":"passed","title":"should accept requests with valid token"}],"endTime":1766964165101,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\auth-middleware.test.ts","startTime":1766964165010,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["API Route Security","Authentication Middleware"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Route Security Authentication Middleware should reject requests without authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165195,"status":"passed","title":"should reject requests without authentication"},{"ancestorTitles":["API Route Security","Authentication Middleware"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Route Security Authentication Middleware should accept requests with valid authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165196,"status":"passed","title":"should accept requests with valid authentication"},{"ancestorTitles":["API Route Security","Rate Limiting"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Route Security Rate Limiting should enforce rate limits","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165196,"status":"passed","title":"should enforce rate limits"},{"ancestorTitles":["API Route Security","Input Validation"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Route Security Input Validation should reject invalid input","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165196,"status":"passed","title":"should reject invalid input"},{"ancestorTitles":["API Route Security","Input Validation"],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"API Route Security Input Validation should accept valid input","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766964165197,"status":"passed","title":"should accept valid input"}],"endTime":1766964165197,"message":"","name":"C:\\Users\\David\\PycharmProjects\\AI Sales Platform\\tests\\api-routes.test.ts","startTime":1766964165105,"status":"passed","summary":""}],"wasInterrupted":false}
